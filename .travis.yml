language: node_js
node_js: node
addons:
  chrome: stable
install:
- npm install
before_script:
- curl -u${ARTIFACTORY_USER}:${ARTIFACTORY_PASS} https://d2lartifacts.artifactoryonline.com/d2lartifacts/api/npm/attest/auth/attest
  > .npmrc
- npm install attest --registry=https://d2lartifacts.artifactoryonline.com/d2lartifacts/api/npm/attest/ --no-save
script:
- npm run lint
- |
  if [ $TRAVIS_PULL_REQUEST != false ] && [ $TRAVIS_SECURE_ENV_VARS == true ]; then
    echo "Pull request with secure environment variables, running Sauce tests...";
    npm run test:polymer:sauce || travis_terminate 1;
  else
    echo "Not a pull request and/or no secure environment variables, running headless tests...";
    npm run test:polymer:local || travis_terminate 1;
  fi
after_success:
- frauci-update-version -d=skip && export TRAVIS_TAG=$(frauci-get-version)
deploy:
  provider: releases
  api_key: "$GITHUB_RELEASE_TOKEN"
  on:
    tags: true
env:
  global:
  - OWNER_NAME=BrightspaceUI
  - REPO_NAME=multi-select
  - SAUCE_USERNAME: D2L_Federation
  - secure: WRjY0q5PELl3MABRxFN4oVXXvLxav0yGuFleBpzWe2JyGcc9gVrdh+y6+5J9SFgxNDCk18/hk0oW3EN/+FhePa9SuRX3xo+9250XOE2NLPtKkz07fGVMVD11jVg6NMSCdL2mBH++kyaDwxqcr4eDx88JB4F/4aqZ1aE8TxVv9cMxLJNdMJnd0uV+1U6cLEHHudpy1qCr4cI9sGbc2S5rByC8q6OqxWIwQJevGaU1plykLOCjUfrpv6kleeNTfK7Od6lJB4tUa4KhDSrNcAI4DGXnFMeah/yH280WpLTnFqRfi+1ASOYgTPQ9czWFZdE60M2trdO/ZibhYm1p5UNx7Q34tFbHpq6QCKBF6xLOyC6NY5x090cC0MM3dp7tb0zyLe/CCcWGKj5n0ZsUIr+0O8qM6UHdVZnJmoag58ajLDR+jzmcQsrIigoQFmXLbqcsjTyJotBpA/Xv+F4jIXBv501Pd/G1WjHvmwYyTQTAtAXvywh6+xtvTAn4vs0cTH4G10uIuL05Sxx/8ViKoMiFzIuLqunYLZERH03oM0nLY07D5A4aqaJpfjn8esyr++1elloefED4+EEA268BOeGfRc+Jwg0usby3gV1PgAhXwGjyE3L374x1YHKZWzWWbHiLL4HO9hcqcWiq+pRNoumbNnLcdueHkJYYQ+hwJBIsxdw=
